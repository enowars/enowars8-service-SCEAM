from email.utils import parseaddr
print("Demonstrating CVE-2023-27043")
# CVE-2023-27043
a = "alice@example.org"
b = "<bob@example.org>"
rfc2822_ADDRESS = "Thomas Dwyer<tdwyer@example.org>"
print("Parsing: '"+rfc2822_ADDRESS+"' as: ", parseaddr(rfc2822_ADDRESS))
tmp = parseaddr(a+"("+b)
print("Parsing: '"+a+" ("+b+"' as: ", tmp)
print("got ", tmp[0], " and ", tmp[1])
print("expected ", a, " and ", b)
